<!DOCTYPE html>
<html>
    <head>
        <title>Spinner</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta name="author" content="Kevin Chen">
        <meta name="description" content="A spinner">
        <meta name="keywords" content="spinner">
        <link rel="icon" href="favicon.ico">
        <link rel="stylesheet" href="spinner.css">
        <script>

            //TODO: disable rotation with disable/enable rotation button
            //TODO: button that enables/disables pulse animation

            function playAnimation(elementClass) {
                var element = document.querySelector(elementClass);
                var animationSpeed = document.querySelector('#animationSpeed').value
                element.style.strokeDasharray = "50, 0"
                element.style.animation = 'uponCompletion ' + animationSpeed + 's cubic-bezier(0.16, 1, 0.3, 1) 1, disappear '+ animationSpeed +'s cubic-bezier(0,.68,.29,1) 1';
                element.style.opacity = "0";
            }
            
            function resetSpinner(elementClass) {
                // var element = document.querySelector(elementClass);
                // // var animationSpeed = document.querySelector('#animationSpeed').value; // Get the animationSpeed from the input
                // // var animationString = 'uponCompletion ' + animationSpeed + 's cubic-bezier(0.16, 1, 0.3, 1) 1, disappear '+ animationSpeed +'s cubic-bezier(0,.68,.29,1) 1'; // Use the correct @keyframes name here
                
                // var newElement = element.cloneNode(true); // Clone the element
                // // newElement.style.animation = animationString; // Apply the new animation settings
                // element.style.animation = 'none';
                // element.style.opacity = "1";
                // element.style.strokeDasharray = "50, 250";

                // element.parentNode.replaceChild(newElement, element); // Replace the old element with the clone
                // newElement.classList.add(toggleClass); // Add the toggleClass if necessary

                

                //copilot
                var element = document.querySelector(elementClass);
                var animationSpeed = document.querySelector('#animationSpeed').value; // Get the animationSpeed from the input

                element.style.animation = 'none'; // Reset the animation
                element.style.opacity = "1"; // Reset the opacity
                element.style.strokeDasharray = "50, 250"; // Reset the stroke dash array

                // Trigger a reflow to apply the style changes immediately
                element.offsetHeight;

                // element.style.animation = 'none'; // Apply the animation settings
            }

            window.onload = function() {
                var playButton = document.querySelector('.play');
                var resetButton = document.querySelector('.reset')
                var dashlengthSlider = document.querySelector('#dashlength');
                var gaplengthSlider = document.querySelector('#gaplength');
                // var completionButton = document.querySelector('#Complete');
                var rotationSpeedSlider = document.querySelector('#rotationSpeed');

                playButton.addEventListener('click', function() {
                    playAnimation('.static circle');
                });

                resetButton.addEventListener('click', function() {
                    resetSpinner('.static circle');
                })

                dashlengthSlider.addEventListener('input', function() {
                    var dashlength = document.querySelector('#dashlength').value;
                    var staticCircle = document.querySelector('.static circle');
                    var staticCircleGap = document.querySelector('#gaplength').value;

                    staticCircle.style.strokeDasharray = dashlength + ' ' + staticCircleGap;

                    var dashlengthValue = document.querySelector('#dashlengthValue');
                    dashlengthValue.textContent = 'Current value: ' + dashlength;
                })

                gaplengthSlider.addEventListener('input', function() {
                    var gaplength = document.querySelector('#gaplength').value;
                    var staticCircle = document.querySelector('.static circle');
                    var staticCircleDash = document.querySelector('#dashlength').value;

                    staticCircle.style.strokeDasharray = staticCircleDash + ' ' + gaplength;

                    var gaplengthValue = document.querySelector('#gaplengthValue');
                    gaplengthValue.textContent = 'Current value: ' + gaplength;
                })

                rotationSpeedSlider.addEventListener('input', function() {
                    // var rotationSpeed = document.querySelector('#rotationSpeed').value;
                    // var min = rotationSpeed.min;
                    // var max = rotationSpeed.max;
                    // var static = document.querySelector('.static');
                    // slider.oninput = function() {
                    //     let invertedValue = max - (rotationSpeed - min)
                    // }

                    // static.style.animation = 'rotate ' + rotationSpeed + 's linear infinite';

                    //copilot
                    //copilot fixed the line of code by retrieving the values from the slider
                    // var rotationSpeedSlider = document.querySelector('#rotationSpeed');
                    // var rotationSpeed = rotationSpeedSlider.value;
                    // var rotationSpeedCurrentValueDisplay = document.querySelector('#rotationSpeedValue');
                    // var min = rotationSpeedSlider.min;
                    // var max = rotationSpeedSlider.max;
                    // var static = document.querySelector('.static');

                    // let invertedValue = max - (rotationSpeed - min);

                    var rotationSpeed = document.querySelector('#rotationSpeed').value;
                    var static = document.querySelector('.static');
                    static.style.animation = "rotate "+rotationSpeed+"s linear infinite"
                    
                    // static.style.animation = 'rotate ' + invertedValue + 's linear infinite';
                })
                

                // completionButton.addEventListener('click', function() {
                //     var staticCircle = document.querySelector('.static circle');
                //     staticCircle.style.strokeDasharray = "50, 0"
                //     staticCircle.style.animation = "uponCompletion 1.5s cubic-bezier(0.16, 1, 0.3, 1) 1, disappear 1.5s cubic-bezier(0,.68,.29,1) 1";
                //     staticCircle.style.opacity = "0";
                // })

            };
        </script>
    </head>
    <body>
        <!-- <div class="spinner"></div> -->
        <!-- <svg class="spinner2" viewBox="0 0 50 50">
            <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="2"></circle>
        </svg> -->
        <h1>Custom Spinner Animation</h1>
        <div>
            <label for="dashlengthSlider">Dash Length:</label>
            <input type="range" id="dashlength" value="50" max="250">
            <p id="dashlengthValue">Current value: 50</p>
        </div>
        <div>
            <label for="gaplengthSlider">Gap Length:</label>
            <input type="range" id="gaplength" value="250" max="300">
            <p id="gaplengthValue">Current value: 250</p>
        </div>
        <div>
            <label for="animationSpeed">Completion Animation Speed: </label>
            <input type="text" id="animationSpeed" value="1.5">
            <button class="play">Play </button>
            <button class="reset">reset</button>
        </div>
        <div id="rotationSpeedDiv">
            <label for="rotationSpeed">Rotation Speed: </label>
            <input type="text" id="rotationSpeed" value="2">
            <!-- <input type="range" id="rotationSpeed" value=2, min="0" max="10" step="0.1"> -->
            <!-- <p id="rotationSpeedValue">Current value: 2</p> -->
        </div>
        <div>
            <p>Presets:</p>
            <button disabled>Google spinner</button>
            <button disabled>Loading</button>
            <button disabled>iOS</button>
        </div>
        
        <div>
            <!-- <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 50 50">
                <polyline id="checkmark" points="10,20 20,30 40,10" stroke="black" stroke-width="4" fill="none" />
            </svg> -->
            <svg class = "static">
                <circle cx="55" cy="55" r="50"/>
            </svg>
        </div>
        <!-- <button id="Complete">Complete</button> -->
        
    </body>
</html>